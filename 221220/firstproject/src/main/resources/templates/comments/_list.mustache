<div id="comments-list" class="m-3">

	{{#commentsDtos}}
	<div id="comments-{{id}}" class="card m-2">
		<div class="card-header">
			{{nickname}}

			<!-- 수정버튼 -->
			<!-- Button tirgger modal -->
			<!-- 버튼이 클릭되면 수정 폼에 commentsDtos의 수정할 데이터를 넣어준다. -->
			<button 
				type="button" 
				class="btn btn-outline-dark btn-sm" 
				data-bs-toggle="modal" 
				data-bs-target="#comment-edit-modal"
				data-bs-id="{{id}}"
				data-bs-nickname="{{nickname}}"
				data-bs-body="{{body}}"
				data-bs-article-id="{{articleId}}"
				>
				수정
			</button>
			
		</div>
		<div class="card-body">{{body}}</div>
	</div>
	{{/commentsDtos}} 
	
	{{^commentsDtos}}
	<div id="comments-{{id}}" class="card m-2">
		<div class="card-body">댓글이 없습니다.</div>
	</div>
	{{/commentsDtos}}
</div>

<!-- Modal -->
<div class="modal fade" id="comment-edit-modal" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">댓글 수정</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			
			<div class="modal-body">
				
				<!-- 댓글 수정 폼 삽입 => _new.mustache 파일의 댓글 작성 폼을 복사해서 수정 -->
				<form >
					<!-- 닉네임 입력 -->
					<div class="mb-3">
						<label for="edit-comment-nickname" class="form-label">닉네임</label>
						<input id="edit-comment-nickname" class="form-control">
					</div>
					
					<!-- 댓글 입력 -->
					<div class="mb-3">
						<label for="edit-comment-body" class="form-label">댓글</label>
						<textarea id="edit-comment-body" class="form-control" rows="5" style="resize: none;"></textarea>
					</div>
					
					<!-- 작성하는 댓글이 어떤 메인글의 댓글인가 저장하기 위해 메인글의 id를 히든으로 전달한다. -->
					<input type="hidden" id="edit-comment-id"> <!-- 댓글 id -->
					<input type="hidden" id="edit-comment-article-id"> <!-- 메인글 id -->
					
					<button id="comment-update-btn" class="btn btn-outline-dark" type="button">댓글수정</button>
				</form>
				
			</div>
		</div>
	</div>
</div>


<!-- 댓글 수정 모달 이벤트 처리 -->
<script type="text/javascript">
{
	// 모달 요소 선택
	const commentEditModal = document.querySelector('#comment-edit-modal');
	// 모달 이벤트 감지
	commentEditModal.addEventListener('show.bs.modal', function (event) {
		// 모달 창이 열릴 때 event에서 트리거 버튼을 선택한다.
		const triggerBtn = event.relatedTarget;
		// 수정 버튼이 클릭될 떄 data-bs-* 데이터 가져오기
		const id = triggerBtn.getAttribute('data-bs-id');
		const nickname = triggerBtn.getAttribute('data-bs-nickname');
		const body = triggerBtn.getAttribute('data-bs-body');
		const articleId = triggerBtn.getAttribute('data-bs-article-id');
		console.log('id: ' + id + ', nickname: ' + nickname + ', body: ' + body + ', articleId: ' + articleId);
		
		// 수정 폼에 데이터를 반영한다.
		document.querySelector('#edit-comment-id').value = id;
		document.querySelector('#edit-comment-nickname').value = nickname;
		document.querySelector('#edit-comment-body').value = body;
		document.querySelector('#edit-comment-article-id').value = articleId;
	})
}
</script>